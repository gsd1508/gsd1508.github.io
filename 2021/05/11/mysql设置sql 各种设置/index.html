<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>设置updateTime 时间触发器 › 忠爱golang</title>
  <meta name="author" content="义薄云天">
  
  <meta name="description" content="this study golang book">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="设置updateTime 时间触发器"/>
  <meta property="og:site_name" content="忠爱golang"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="忠爱golang" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header id="header"><div class="meta inner">
  <h1><a href="/">忠爱golang</a></h1>
  <h2><a href="/">快乐学习</a></h2>
  <nav id="main-nav">
    <ul>
      
      <li><a href="/archives">归类</a></li>
      
      <li><a href="/atom.xml">订阅</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
</div>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  <div class="post-content">
    <header>
      
  
    <h1 class="title">设置updateTime 时间触发器</h1>
  

      
        <time datetime="2021-05-11T12:16:48.000Z">2021-05-11</time>
      
    </header>
    <div class="entry">
      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 命令 </span><br><span class="line">alter table leisuDb.courtTableListOne modify column updateTimeAt timestamp NULL DEFAULT current_timestamp() ON UPDATE current_timestamp();</span><br></pre></td></tr></table></figure>

<h4 id="时间戳查询"><a href="#时间戳查询" class="headerlink" title="时间戳查询"></a>时间戳查询</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * from gungun_zuqiu_odds where update_at = unix_timestamp(&#x27;2019-12-11 13:00:31&#x27;);</span><br><span class="line">只取年月日查询</span><br><span class="line">select * from date_format(FROM_UNIXTIME(update_at), &#x27;%Y-%m-%d&#x27;) =  date_format(now(), &#x27;%Y-%m-%d&#x27;)</span><br><span class="line"># 查询时间戳</span><br><span class="line">SELECT asian_capot_m,asian_capot_tie,asian_capot_g,big,little,size_t from gungun_zuqiu_odds  where FROM_UNIXTIME(create_at, &#x27;%Y-%m-%d&#x27;)= &#x27;2020-12-09&#x27;;</span><br></pre></td></tr></table></figure>

<h4 id="mysql-相差8个小时"><a href="#mysql-相差8个小时" class="headerlink" title="mysql 相差8个小时"></a>mysql 相差8个小时</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 命令</span><br><span class="line">select now();</span><br><span class="line">show variables like &#x27;%time_zone%&#x27;;</span><br><span class="line">set global time_zone = &#x27;+8:00&#x27;;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>

<h4 id="关于修改MySQL数据库字符集"><a href="#关于修改MySQL数据库字符集" class="headerlink" title="关于修改MySQL数据库字符集"></a>关于修改MySQL数据库字符集</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alter database dev_score default character set utf8 COLLATE utf8_general_ci;</span><br></pre></td></tr></table></figure>

<h4 id="mysql-设置触发器-可触发表每一行有变化的数据"><a href="#mysql-设置触发器-可触发表每一行有变化的数据" class="headerlink" title="mysql 设置触发器(可触发表每一行有变化的数据)"></a>mysql 设置触发器(可触发表每一行有变化的数据)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">delimiter $</span><br><span class="line">create trigger credit_get</span><br><span class="line">after update on gungun_zuqiu_competition</span><br><span class="line">for each row</span><br><span class="line">begin</span><br><span class="line">if (select id from gungun_zuqiu_competitionTemp where id = NEW.id) = NEW.id</span><br><span class="line">then</span><br><span class="line">update gungun_zuqiu_competitionTemp set id = NEW.id,lsid =NEW.lsid,begin_date = NEW.begin_date,lsname = NEW.lsname,begin1=NEW.begin1,team1 = NEW.team1,team2 = NEW.team2,</span><br><span class="line">aside1=NEW.aside1,aside2 = NEW.aside2,assault1=NEW.assault2,control1=NEW.assault1,control2=NEW.control2,corner1=NEW.corner1,</span><br><span class="line">corner2=NEW.corner2,door1=NEW.door1,door2=NEW.door2,half1=NEW.half1,half2=NEW.half2,red1=NEW.red1,red2=NEW.red2,risk1=NEW.risk1,</span><br><span class="line">risk2 = NEW.risk2,s1= NEW.s1,s2=NEW.s2,yellow1=NEW.yellow1,yellow2 = NEW.yellow2,zheng1= NEW.zheng1,zheng2 =NEW.zheng2,dot1=NEW.dot1,</span><br><span class="line">dot2 = NEW.dot2,status = NEW.status where id = NEW.id;</span><br><span class="line">elseif NEW.status = 1 or NEW.status=2 or NEW.status = 3 or NEW.status = -1 or NEW.status = 0</span><br><span class="line">then</span><br><span class="line">insert into gungun_zuqiu_competitionTemp(id,lsid,begin_date,lsname,begin1,team1,team2,aside1,</span><br><span class="line">aside2,assault1,assault2,control1,control2,corner1,corner2,door1,door2,half1,half2,red1,red2,risk1,risk2,</span><br><span class="line">s1,s2,yellow1,yellow2,zheng1,zheng2,dot1,dot2,</span><br><span class="line">team1id,team2id,ynamicTime,st_at,status,placeName)</span><br><span class="line">values (NEW.id,NEW.lsid,NEW.begin_date,NEW.lsname,NEW.begin1,NEW.team1,NEW.team2,NEW.aside1,NEW.aside2,NEW.assault1,NEW.assault2,</span><br><span class="line">NEW.control1,NEW.control2,NEW.corner1,NEW.corner2,NEW.door1,NEW.door2,NEW.half1,NEW.half2,NEW.red1,NEW.red2,NEW.risk1,</span><br><span class="line">NEW.risk2,NEW.s1,NEW.s2,NEW.yellow1,NEW.yellow2,NEW.zheng1,NEW.zheng2,NEW.dot1,NEW.dot2,NEW.team1id,NEW.team2id,NEW.ynamicTime,</span><br><span class="line">NEW.st_at,NEW.status,NEW.placeName);</span><br><span class="line">end if;</span><br><span class="line">end$</span><br></pre></td></tr></table></figure>

<h4 id="触发器例子"><a href="#触发器例子" class="headerlink" title="触发器例子"></a>触发器例子</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">create definer = root@`%` trigger bbbb</span><br><span class="line">    after update</span><br><span class="line">    on gungun_zuqiu_competition</span><br><span class="line">    for each row</span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line">		  DELETE from gungun_zuqiu_competitionTemp where old.`status`=-1;</span><br><span class="line">	IF</span><br><span class="line">		((old.s1+old.s2+old.half1+old.half2+old.yellow1+old.yellow2+old.red1+old.red2+old.corner1+old.corner2+old.control1+old.control2+old.door1+old.door2)</span><br><span class="line">		!=</span><br><span class="line">		(new.s1+new.s2+new.half1+new.half2+new.yellow1+new.yellow2+new.red1+new.red2+new.corner1+new.corner2+new.control1+new.control2+new.door1+new.door2))</span><br><span class="line">		or</span><br><span class="line">		(old.`status`!=new.`status`)</span><br><span class="line">		THEN</span><br><span class="line">		  DELETE from gungun_zuqiu_competitionTemp where id=new.id;</span><br><span class="line">			insert into gungun_zuqiu_competitionTemp  select * from gungun_zuqiu_competition where id =new.id;</span><br><span class="line">	END IF;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>




      
    </div>
      
      <footer>
        
        
        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
      </footer>
  </div>
</article>


<section id="comment">
  
</section>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:gsd1508.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2021/05/12/post/">post</a>
      </li>
    
      <li>
        <a href="/2021/05/11/golang交叉编译/">golang交叉编译</a>
      </li>
    
      <li>
        <a href="/2021/05/11/mysql设置sql 各种设置/">设置updateTime 时间触发器</a>
      </li>
    
      <li>
        <a href="/2021/05/11/hello-world/">我的golang博客</a>
      </li>
    
  </ul>
</div>


  

  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/golang/" style="font-size: 10px;">golang</a>
  </div>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2021 义薄云天
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



</body>
</html>

